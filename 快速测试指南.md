# 🧪 API 测试快速指南

## 在浏览器中测试（最简单）

### 步骤详解：

1. **打开 API 文档页面**
   - 访问：http://localhost:8000/docs

2. **找到体质判定接口**
   - 页面会显示所有 API 端点
   - 找到 `POST /constitution/estimate` 这一行
   - 点击它，会展开详细信息

3. **点击 "Try it out" 按钮**
   - 在展开的接口详情中，右上角有一个绿色的 "Try it out" 按钮
   - 点击后，页面会变成可编辑状态

4. **填写请求内容**
   - 在 "Request body" 区域，你会看到一个 JSON 编辑器
   - 删除默认的 `{}`
   - 粘贴以下内容（或从 `测试示例.json` 中复制）：

   ```json
   {
     "text": "我最近总是感觉很累，容易疲劳，说话声音也比较低，稍微动一下就出汗，还经常感冒。",
     "meta": {
       "age": 35,
       "sex": "M",
       "region": "CN"
     }
   }
   ```

5. **点击 "Execute" 按钮**
   - 在页面底部有一个蓝色的 "Execute" 按钮
   - 点击后，请求会发送到服务器

6. **查看结果**
   - 在 "Responses" 区域会显示：
     - **Code**: 200（表示成功）
     - **Response body**: 完整的体质判定结果，包括：
       - `primary_type`: 主要体质类型
       - `secondary_types`: 次要体质类型
       - `confidence`: 置信度
       - `evidence`: 匹配的关键词证据
       - `recommendations`: 生活建议
       - `questions_to_clarify`: 需要澄清的问题
       - `disclaimer`: 免责声明

## 测试示例

### 示例 1：气虚质
```json
{
  "text": "我最近总是感觉很累，容易疲劳，说话声音也比较低，稍微动一下就出汗，还经常感冒。",
  "meta": {
    "age": 35,
    "sex": "M"
  }
}
```

### 示例 2：阳虚质
```json
{
  "text": "我特别怕冷，手脚总是冰凉的，喜欢喝热水，不敢吃凉的，大便也不成形。",
  "meta": {
    "age": 42,
    "sex": "F"
  }
}
```

### 示例 3：阴虚质
```json
{
  "text": "我经常口干，想喝水，手心脚心发热，晚上睡觉会出汗，大便比较干燥，容易失眠。",
  "meta": {
    "age": 28,
    "sex": "F"
  }
}
```

### 示例 4：信息不足（测试边界情况）
```json
{
  "text": "有点不舒服",
  "meta": {
    "age": 25,
    "sex": "M"
  }
}
```

## 使用 curl 命令测试（命令行方式）

如果你想在终端中测试，可以使用 curl：

```bash
curl -X POST "http://localhost:8000/constitution/estimate" \
  -H "Content-Type: application/json" \
  -d '{
    "text": "我最近总是感觉很累，容易疲劳",
    "meta": {
      "age": 35,
      "sex": "M"
    }
  }'
```

## 响应结果说明

成功响应会包含以下字段：

- **primary_type**: 主要体质类型（如"气虚质"）
- **secondary_types**: 次要体质类型数组（可能为空）
- **confidence**: 置信度（0.0-1.0，越高越可信）
- **evidence**: 证据列表，显示匹配到的关键词
- **recommendations**: 
  - `lifestyle`: 生活方式建议
  - `diet`: 饮食建议
  - `when_to_seek_help`: 何时寻求专业帮助
- **questions_to_clarify**: 需要补充的问题列表
- **disclaimer**: 免责声明

## 常见问题

**Q: 为什么返回"信息不足"？**
A: 输入的文本太短或没有匹配到足够的体质特征关键词。尝试输入更详细的症状描述。

**Q: 可以只填写 text 字段吗？**
A: 可以，`meta` 字段是可选的。但填写年龄、性别等信息有助于更准确的判定。

**Q: 如何测试不同的体质？**
A: 参考 `测试示例.json` 文件，里面有各种体质的测试用例。
